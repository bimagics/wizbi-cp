<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>WizBI Control Plane</title>
  <link rel="stylesheet" href="/styles.css" />
  <link rel="stylesheet" href="/admin/admin.css" />
  <script src="/__/firebase/9.6.1/firebase-app-compat.js"></script>
  <script src="/__/firebase/9.6.1/firebase-auth-compat.js"></script>
  <script src="/__/firebase/init.js"></script>
</head>
<body>

  <div class="page-container">

    <div id="loginContainer" class="login-container">
      <h1>WizBI Control Plane</h1>
      <p>Please log in to continue.</p>
      <button id="btnLogin" class="login-button">
        <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google icon">
        <span>Sign in with Google</span>
      </button>
    </div>

    <div id="unauthorizedContainer" class="unauthorized-container hidden">
      <h2>Access Denied</h2>
      <p>You are not authorized to view this page. This panel is for administrators only.</p>
      <p>If you believe this is an error, please contact support at:<br><a href="mailto:omer.cohen@bimagics.com">omer.cohen@bimagics.com</a></p>
      <button id="btnLogoutUnauthorized">Logout</button>
    </div>
    
    <div id="adminPanelContainer" class="admin-panel-container hidden">
      <header class="header">
        <h1>WizBI Control Plane</h1>
        <div class="user-auth">
          <span id="userEmail"></span>
          <button id="btnLogoutAdmin">Logout</button>
        </div>
      </header>
      <main>
        <div class="tabs">
          <button id="btnTabProjects" class="tab-button active">Projects</button>
          <button id="btnTabOrgs" class="tab-button">Organizations</button>
        </div>
        <div id="tabContentProjects" class="tab-content active">
          <div class="card">
              <h2>Provision New Project</h2>
              <form id="formProvisionProject" class="form-grid">
                  <select id="projectOrgId" class="full-width" required><option value="" disabled selected>Select an Organization</option></select>
                  <input type="text" id="projectId" placeholder="Unique Project ID" required minlength="6" pattern="[a-z0-9-]+" title="Must be at least 6 characters, and can only contain lowercase letters, numbers, and hyphens.">
                  <input type="text" id="projectDisplayName" placeholder="Display Name (e.g., 'Acme Website')" required>
                  <button type="submit">Provision Project</button>
              </form>
          </div>
          <h2>Existing Projects</h2>
          <div id="projectsSpinner" class="spinner"></div>
          <div class="table-wrapper">
            <table id="projectsTable" class="data-table">
              <thead><tr><th>Project ID</th><th>Display Name</th><th>Org ID</th><th>State</th><th>Links</th><th>Created At</th><th>Actions</th></tr></thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
        <div id="tabContentOrgs" class="tab-content">
          <div class="card">
              <h2>Create New Organization</h2>
              <form id="formCreateOrg" class="form-grid">
                  <input type="text" id="orgName" placeholder="Organization Name" required>
                  <input type="tel" id="orgPhone" placeholder="Contact Phone (Optional)">
                  <button type="submit">Create Org</button>
              </form>
          </div>
          <h2>Existing Organizations</h2>
          <div id="orgsSpinner" class="spinner"></div>
          <div class="table-wrapper">
              <table id="orgsTable" class="data-table">
                  <thead><tr><th>ID</th><th>Name</th><th>Phone</th><th>Created At</th><th>Actions</th></tr></thead>
                  <tbody></tbody>
              </table>
          </div>
        </div>
        <pre id="statusLog" class="status-log">Welcome! System is ready.</pre>
      </main>
    </div>
  </div>

<script src="/admin/admin.js"></script>
</body>
</html>
